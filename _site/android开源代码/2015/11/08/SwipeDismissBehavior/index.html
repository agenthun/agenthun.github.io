
<!DOCTYPE html>
<html>
  <head>
    <meta http-equiv="Content-Type" content="text/html; charset=UTF-8"/>
    <meta name="theme-color" content="#2196F3">
    <title>SwipeDismissBehavior用法及实现原理</title>
    <!-- <meta name="description" content="design兼容库中SwipeDismissBehavior类，用来实现滑动删除"> -->
    <meta name="author" content="agenthun">

    <!-- Enable responsive viewport -->
    <meta name="viewport" content="width=device-width, initial-scale=1, maximum-scale=1.0, user-scalable=no"/>

    <!-- Le HTML5 shim, for IE6-8 support of HTML elements -->
    <!--[if lt IE 9]>
      <script src="http://html5shim.googlecode.com/svn/trunk/html5.js"></script>
    <![endif]-->

    <!-- Le styles -->
    <link href="/assets/themes/material-design/css/materialize.css" type="text/css" rel="stylesheet">
    <link href="/assets/themes/material-design/css/style.css" type="text/css" rel="stylesheet">
    <link href="/assets/themes/material-design/css/font-awesome.min.css" type="text/css" rel="stylesheet">
    
    <link href="/assets/themes/material-design/css/lrtk.css" type="text/css" rel="stylesheet">
    <script src="/js/modernizr.js"></script> <!-- Modernizr -->
    <script src="/js/jquery.min.js"></script>

    <!-- Le fav and touch icons -->
    <!-- Update these with your own images -->
    <link rel="shortcut icon" href="/img/icon/favicon.ico">
    <link rel="apple-touch-icon" href="/img/icon/apple-touch-icon.png">
    <link rel="apple-touch-icon" sizes="72x72" href="/img/icon/apple-touch-icon-72x72.png">
    <link rel="apple-touch-icon" sizes="114x114" href="/img/icon/apple-touch-icon-114x114.png">
 

    <!-- atom & rss feed -->
    <link href="/atom.xml" type="application/atom+xml" rel="alternate" title="Sitewide ATOM Feed">
    <link href="/rss.xml" type="application/rss+xml" rel="alternate" title="Sitewide RSS Feed">

  </head>

  <body id="top" class="scrollspy">

    <!-- Pre Loader -->
    <div id="loader-wrapper">
        <div id="loader"></div>
        
        <div class="loader-section section-left"></div>
        <div class="loader-section section-right"></div>
     
    </div>

    <!--Navigation-->
     <div class="navbar-fixed">
        <nav id="nav_f" class="default_color" role="navigation">
            <div class="container">
                <div class="nav-wrapper"><a id="logo-container" href="#top" class="brand-logo">踏雪无痕d博客</a>
                <ul id="nav-mobile" class="right side-nav">
                    <li><a href="/">首页</a></li>
                    
                    
                    


  
    
      
      	
      	<li><a href="/archive/">文章</a></li>
      	
      
    
  
    
      
    
  
    
      
      	
      	<li><a href="/categories/">分类</a></li>
      	
      
    
  
    
      
    
  
    
      
    
  
    
      
    
  



                    <!-- <li><a href="/#contact">关于我</a></li> -->
                </ul><a href="/#" data-activates="nav-mobile" class="button-collapse"><i class="mdi-navigation-menu"></i></a>
                </div>
            </div>
        </nav>
    </div>


    <div class="container-narrow">

      <div class="content">
        
<!-- <div class="page-header">
  <h1>SwipeDismissBehavior用法及实现原理 <small>Supporting tagline</small></h1>
</div> -->

<div class="section scrollspy" id="archive">
  <div class="container">
        <div class="card card-padding">
      <div class="span12">
            <div class="date">
              <span>08 November 2015</span>
            </div>
            <div class="content">
              
<h1 id="swipedismissbehavior">SwipeDismissBehavior用法及实现原理</h1>

<p><a href="http://www.jcodecraeer.com/a/anzhuokaifa/androidkaifa/2015/1103/3650.html">原文</a></p>

<h2 id="section">引文</h2>
<p>无意间发现design兼容库中有一个叫做SwipeDismissBehavior的类，顾名思义它就是用来实现滑动删除的了。莫非现在滑动删除又有更简单的解决办法了？鉴于之前RecyclerView中已经有ItemTouchHelper，而且也非常简单，所以很好奇到底有何不同，于是决定研究研究，看看它的实现原理以及应用场景：真的能替代其他的（不管是第三方还是RecyclerView自带的ItemTouchHelper）滑动删除吗？。</p>

<p>很不幸SwipeDismissBehavior现在的文档还很少，只有stackoverfolw上有点价值的讨论。</p>

<p>先来直接从API的角度使用SwipeDismissBehavior，然后再讲解SwipeDismissBehavior的原理。从而说明为什么SwipeDismissBehavior只能和CoordinatorLayout一起使用？为什么SwipeDismissBehavior对CoordinatorLayout中RecyclerView的item不起作用。</p>

<h2 id="swipedismissbehavior-1">SwipeDismissBehavior的用法</h2>
<p>SwipeDismissBehavior的用法非常简单。</p>

<h3 id="design">第一步：引入design库</h3>
<pre><code>compile 'com.android.support:appcompat-v7:23.1.0'
compile 'com.android.support:design:23+'
</code></pre>

<h3 id="viewcoordinatorlayout">第二步：把要滑动删除的View放在CoordinatorLayout中</h3>
<p>xml代码：</p>

<?xml version="1.0" encoding="utf-8"?>
<pre><code>&lt;android.support.design.widget.CoordinatorLayout xmlns:android="http://schemas.android.com/apk/res/android"
    xmlns:app="http://schemas.android.com/apk/res-auto"
    xmlns:tools="http://schemas.android.com/tools"
    android:id="@+id/coordinatorLayout"
    android:layout_width="match_parent"
    android:layout_height="match_parent"&gt;
 
    &lt;TextView
        android:id="@+id/swip"
        android:layout_width="match_parent"
        android:layout_height="200dip"
        android:background="#32CD32"
        android:text="别删我"
        android:textSize="20dip"
        android:gravity="center"
    /&gt;
 
&lt;/android.support.design.widget.CoordinatorLayout&gt;
</code></pre>

<h3 id="mainactivityviewswipedismissbehavior">第三步：在MainActivity中为View设置一个SwipeDismissBehavior对象</h3>
<pre><code>package com.jcodecraeer.swipedismissbehaviordemo;
 
import android.os.Bundle;
import android.support.design.widget.CoordinatorLayout;
import android.support.design.widget.SwipeDismissBehavior;
import android.support.v7.app.AppCompatActivity;
import android.view.View;
import android.widget.TextView;
 
public class MainActivity extends AppCompatActivity {
 
    @Override
    protected void onCreate(Bundle savedInstanceState) {
        super.onCreate(savedInstanceState);
        setContentView(R.layout.activity_main);
        TextView swipeView = (TextView)findViewById(R.id.swip);
        final SwipeDismissBehavior&lt;View&gt; swipe
                = new SwipeDismissBehavior();
 
        swipe.setSwipeDirection(
                SwipeDismissBehavior.SWIPE_DIRECTION_ANY);
 
        swipe.setListener(
                new SwipeDismissBehavior.OnDismissListener() {
                    @Override public void onDismiss(View view) {
 
                    }
 
                    @Override
                    public void onDragStateChanged(int state) {}
                });
 
        CoordinatorLayout.LayoutParams coordinatorParams =
                (CoordinatorLayout.LayoutParams) swipeView.getLayoutParams();
 
        coordinatorParams.setBehavior(swipe);
    }
     
}
</code></pre>

<h2 id="section-1">效果如下所示</h2>

<p><img src="/img/SwipeDismissBehavior用法及实现原理/effect.gif" alt="effect" /></p>

            </div>
        
        <div class="pagination clearfix">
          <ul class = "pull-right">
          
            <li class="prev"><a class="fa fa-arrow-circle-left" href="/android%E5%BC%80%E6%BA%90%E4%BB%A3%E7%A0%81/2015/11/02/FoldableLayout/" title="FoldableLayout"> 前一篇</a></li>
          
            <li><a class="fa fa-th" href="/archive"> 所有日志</a></li>
          
            <li class="next disabled"><a >后一篇 <span class="fa fa-arrow-circle-right">  </span></a>
          
          </ul>
        </div>
        <hr>
        


  <div id="disqus_thread"></div>
<script type="text/javascript">
    
    var disqus_developer = 1;
    var disqus_shortname = 'jekyllbootstrap'; // required: replace example with your forum shortname
    
    /* * * DON'T EDIT BELOW THIS LINE * * */
    (function() {
        var dsq = document.createElement('script'); dsq.type = 'text/javascript'; dsq.async = true;
        dsq.src = 'http://' + disqus_shortname + '.disqus.com/embed.js';
        (document.getElementsByTagName('head')[0] || document.getElementsByTagName('body')[0]).appendChild(dsq);
    })();
</script>
<noscript>Please enable JavaScript to view the <a href="http://disqus.com/?ref_noscript">comments powered by Disqus.</a></noscript>
<a href="http://disqus.com" class="dsq-brlink">blog comments powered by <span class="logo-disqus">Disqus</span></a>




      </div>
    </div>
  </div>
</div>


      </div>

      <div class="actGotop"><a href="javascript:;" title="回到顶部"></a></div>
      <script type="text/javascript">
      $(function(){ 
        $(window).scroll(function() {   
          if($(window).scrollTop() >= 100){ //向下滚动像素大于这个值时，即出现小火箭~
            $('.actGotop').fadeIn(300); //火箭淡入的时间，越小出现的越快~
          }else{    
            $('.actGotop').fadeOut(300); //火箭淡出的时间，越小消失的越快~
          }  
        });
        $('.actGotop').click(function(){$('html,body').animate({scrollTop: '0px'}, 800);}); //火箭动画停留时间，越小消失的越快~
      });
      </script>

      <hr>

    </div>

    <!--Footer-->
    <footer id="contact" class="page-footer default_color scrollspy">
        <div class="container">  
            <div class="row">
                <div class="col l6 s12">
                    <form class="col s12">
                        <div class="row">
                            <div class="input-field col s6">
                                <i class="mdi-action-account-circle prefix white-text"></i>
                                <input id="icon_prefix" type="text" class="validate white-text">
                                <label for="icon_prefix" class="white-text">First Name</label>
                            </div>
                            <div class="input-field col s6">
                                <i class="mdi-communication-email prefix white-text"></i>
                                <input id="icon_email" type="email" class="validate white-text">
                                <label for="icon_email" class="white-text">Email-id</label>
                            </div>
                            <div class="input-field col s12">
                                <i class="mdi-editor-mode-edit prefix white-text"></i>
                                <textarea id="icon_prefix2" class="materialize-textarea white-text"></textarea>
                                <label for="icon_prefix2" class="white-text">Message</label>
                            </div>
                            <div class="col offset-s7 s5">
                                <button class="btn waves-effect waves-light red darken-1" type="submit" name="action">Submit
                                    <i class="mdi-content-send right white-text"></i>
                                </button>
                            </div>
                        </div>
                    </form>
                </div>
                <div class="col l3 s12">
                    <h5 class="white-text">agenthun.com</h5>
                    <ul>
                        <!-- <li><a class="white-text" href="http://www.joashpereira.com/">Home</a></li> -->
                        <li><a class="white-text" href="http://agenthun.github.io">Blog</a></li>
                    </ul>
                </div>
                <div class="col l3 s12">
                    <h5 class="white-text">Social</h5>
                    <ul>
    <!--                     <li>
                            <a class="white-text" href="https://www.behance.net/joashp">
                                <i class="small fa fa-behance-square white-text"></i> Behance
                            </a>
                        </li> -->
                        <li>
                            <a class="white-text" href="https://www.facebook.com/agenthun">
                                <i class="small fa fa-facebook-square white-text"></i> Facebook
                            </a>
                        </li>
                        <li>
                            <a class="white-text" href="https://github.com/agenthun">
                                <i class="small fa fa-github-square white-text"></i> Github
                            </a>
                        </li>
    <!--                     <li>
                            <a class="white-text" href="https://www.linkedin.com/in/joashp">
                                <i class="small fa fa-linkedin-square white-text"></i> Linkedin
                            </a>
                        </li> -->
                    </ul>
                </div>
            </div>
        </div>
        <div class="footer-copyright default_color">
            <div class="container">
                Made by <a class="white-text" href="http://joashpereira.com">agenthun</a>. Thanks to <a class="white-text" href="http://materializecss.com/">materializecss</a>
            </div>
        </div>
    </footer>

    <!--  Scripts-->
    <script src="https://code.jquery.com/jquery-2.1.1.min.js"></script>
    <script src="js/materialize.js"></script>
    <script src="js/init.js"></script>
    



  </body>
</html>

